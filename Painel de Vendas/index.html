<!doctype html>
<html lang="pt-br">
<head>
    <meta charset="utf-8">
    <title>Vendas | RuaRoma Sunset</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <!-- Fonts (ajuste se preferir outra) -->
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        :root{
            --brand-red: #E63A2E;     /* vermelho da marca */
            --brand-green: #197a3b;   /* verde secund치rio */
            --bg-left: #071e26;       /* fundo escuro */
            --bg-right: #0f3a45;      /* fundo escuro 2 */
            --accent: #2ea3ff;        /* acento azul para inputs */
            --card-bg: rgba(0,0,0,0.55);
            --muted: #cfdde6;
            --text: #ffffff;
        }

        /* tipografia */
        body { font-family: "Inter", Arial, Helvetica, sans-serif; color:var(--text); background-image: linear-gradient(90deg,var(--bg-left),var(--bg-right)); }

        /* Centraliza painel na tela com padding seguro */
        html, body { height: 100%; box-sizing: border-box; }
        body {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 32px;
            margin: 0;
            background-image: linear-gradient(90deg, var(--bg-left, #071e26), var(--bg-right, #0f3a45));
            font-family: "Inter", Arial, Helvetica, sans-serif;
        }

        /* Caixa do painel */
        .box{
            width: 360px;
            max-width: calc(100% - 48px);
            margin: 0 auto;
            border-radius: 15px;
            background: var(--card-bg, rgba(0,0,0,0.6));
            padding: 18px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.6);
        }

        /* logo / brand */
        .brand { display:flex; align-items:center; justify-content:center; margin-bottom:12px; gap:10px; }
        .brand img { max-width:220px; height:auto; display:block; }
        #brand-text { display:none; font-family: "Pacifico", cursive; color: var(--brand-red, #E63A2E); font-size:20px; }

        h2 { text-align:center; margin:8px 0 16px; }
        .categorias { display:flex; gap:12px; justify-content:center; margin-bottom:12px; }
        .categoria-btn{
            background: linear-gradient(180deg, var(--brand-red), #b83228);
            border: none;
            color: #fff;
            padding:12px;
            border-radius:8px;
            width:140px;
            height:96px;
            cursor:pointer;
            display:flex;
            flex-direction:column;
            align-items:center;
            justify-content:center;
            gap:6px;
        }
        .categoria-icone { font-size:34px; }
        form fieldset{ border:2px solid rgba(30,144,255,0.9); padding:12px; border-radius:8px; }
        legend{ background: var(--brand-red); color:white; font-family: "Pacifico", cursive; padding:6px 10px; border-radius:6px; }
        .pedido-item{ display:flex; align-items:center; gap:8px; margin:8px 0; }
        .qtd-input{ width:60px; padding:6px; border-radius:6px; border:1px solid #2ea3ff; background:transparent; color:white; }
        .inputBox{ position:relative; margin-top:8px; }
        .inputUser{ background:none; border:none; border-bottom:1px solid white; outline:none; color:white; padding:6px 4px; width:100%; }
        label.labelInput{ position:absolute; left:0; top:0; pointer-events:none; transition:.3s; color:#ccc; font-size:14px; }
        input.inputUser:focus + .labelInput,
        input.inputUser:not([value=""]) + .labelInput,
        input.inputUser:valid + .labelInput { top:-18px; font-size:12px; color:dodgerblue; }
        #valorTotalCompra { border:none; padding:8px; border-radius:6px; outline:none; font-size:16px; color:white; background:transparent; width:100%; }
        #submit-btn{ background-image: linear-gradient(90deg, var(--brand-red), #8f2b24); width:100%; border:none; padding:12px; color:white; font-size:16px; cursor:pointer; border-radius:8px; margin-top:8px;}
        #submit-btn:hover{ filter:brightness(.95); }
        .voltar-btn{ background: var(--brand-green); color:#fff; border:none; padding:6px 10px; border-radius:6px; cursor:pointer; margin-bottom:8px;}

        /* Estilo espec칤fico para o label est치tico do Valor Total */
        .labelInput.staticLabel {
            position: static;
            display: block;
            margin-bottom: 6px;
            color: #cfdde6;
            font-size: 13px;
        }

        /* Estilo do campo de valor total para melhor leitura */
        .valor-input {
            width: 100%;
            padding: 8px 10px;
            border-radius: 6px;
            border: 1px solid rgba(46,163,255,0.14);
            background: rgba(0,0,0,0.15);
            color: var(--text);
            font-size: 18px;
            text-align: right; /* ou "center" se preferir */
            box-sizing: border-box;
        }
        .valor-input[readonly] {
            cursor: default;
            opacity: 1;
        }

        /* destaque de foco */
        .qtd-input, .inputUser { border:1px solid rgba(46,163,255,0.1); }
        .inputUser:focus, .qtd-input:focus { box-shadow:0 0 0 3px rgba(46,163,255,0.08); border-color:var(--accent); outline:none; }
    </style>

    <!-- jsPDF (usado para gerar PDF no envio) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <div class="box">
        <!-- marca / logo: coloque a imagem em assets/logo.png -->
        <div class="brand">
            <img src="assets/logo.png" alt="RuaRoma Logo"
                 onerror="this.style.display='none'; document.getElementById('brand-text').style.display='inline-block'">
            <span id="brand-text">Vendas RuaRoma Sunset</span>
        </div>

        <!-- Tela de categorias -->
        <div id="tela-categorias">
            <h2>Escolha uma Categoria</h2>
            <div class="categorias">
                <button class="categoria-btn" type="button" onclick="mostrarCategoria('pizzas')">
                    <span class="categoria-icone">游꼣</span>
                    <span>Pizzas</span>
                </button>
                <button class="categoria-btn" type="button" onclick="mostrarCategoria('bebidas')">
                    <span class="categoria-icone">游꽂</span>
                    <span>Bebidas</span>
                </button>
            </div>
        </div>

        <!-- Formul치rio (escondido inicialmente) -->
        <form id="formulario-pedido" style="display:none;">
            <fieldset>
                <legend><b>Vendas RuaRoma Sunset</b></legend>

                <p style="margin:8px 0 4px;">Pedidos (selecione os itens desejados):</p>

                <!-- Pizzas -->
                <div class="pedido-item item-pizza" id="item-mussarela">
                    <input type="checkbox" id="mussarela" name="item_pedido" value="mussarela">
                    <label for="mussarela">Mussarela - R$25,00</label>
                    <input type="number" id="qtd_mussarela" class="qtd-input" value="0" min="0" max="99">
                </div>
                <div class="pedido-item item-pizza">
                    <input type="checkbox" id="calabresa" name="item_pedido" value="calabresa">
                    <label for="calabresa">Calabresa - R$20,00</label>
                    <input type="number" id="qtd_calabresa" class="qtd-input" value="0" min="0" max="99">
                </div>
                <div class="pedido-item item-pizza">
                    <input type="checkbox" id="pepperoni" name="item_pedido" value="pepperoni">
                    <label for="pepperoni">Pepperoni - R$30,00</label>
                    <input type="number" id="qtd_pepperoni" class="qtd-input" value="0" min="0" max="99">
                </div>
                <div class="pedido-item item-pizza">
                    <input type="checkbox" id="ragu_linguica" name="item_pedido" value="ragu_linguica">
                    <label for="ragu_linguica">Rag칰 - R$35,00</label>
                    <input type="number" id="qtd_ragu_linguica" class="qtd-input" value="0" min="0" max="99">
                </div>
                <div class="pedido-item item-pizza">
                    <input type="checkbox" id="pannacotta" name="item_pedido" value="pannacotta">
                    <label for="pannacotta">Pannacotta - R$15,00</label>
                    <input type="number" id="qtd_pannacotta" class="qtd-input" value="0" min="0" max="99">
                </div>

                <!-- Bebidas -->
                <p style="margin-top:10px;">Bebidas:</p>
                <div class="pedido-item item-bebida">
                    <input type="checkbox" id="cuba" name="item_pedido" value="cuba">
                    <label for="cuba">Cuba - R$20,00</label>
                    <input type="number" id="qtd_cuba" class="qtd-input" value="0" min="0" max="99">
                </div>
                <div class="pedido-item item-bebida">
                    <input type="checkbox" id="caipirinha" name="item_pedido" value="caipirinha">
                    <label for="caipirinha">Caipirinha - R$20,00</label>
                    <input type="number" id="qtd_caipirinha" class="qtd-input" value="0" min="0" max="99">
                </div>
                <div class="pedido-item item-bebida">
                    <input type="checkbox" id="mojito" name="item_pedido" value="mojito">
                    <label for="mojito">Mojito - R$25,00</label>
                    <input type="number" id="qtd_mojito" class="qtd-input" value="0" min="0" max="99">
                </div>
                <div class="pedido-item item-bebida">
                    <input type="checkbox" id="ginpesto" name="item_pedido" value="ginpesto">
                    <label for="ginpesto">GinPesto - R$25,00</label>
                    <input type="number" id="qtd_ginpesto" class="qtd-input" value="0" min="0" max="99">
                </div>
                <div class="pedido-item item-bebida">
                    <input type="checkbox" id="refrigerante" name="item_pedido" value="refrigerante">
                    <label for="refrigerante">Refrigerante - R$8,00</label>
                    <input type="number" id="qtd_refrigerante" class="qtd-input" value="0" min="0" max="99">
                </div>
                <div class="pedido-item item-bebida">
                    <input type="checkbox" id="agua" name="item_pedido" value="agua">
                    <label for="agua">츼gua - R$5,00</label>
                    <input type="number" id="qtd_agua" class="qtd-input" value="0" min="0" max="99">
                </div>

                <!-- Substitua esta se칞칚o antiga do Valor Total (que tinha label sobreposto) por esta -->
                <div class="inputBox" style="margin-top:10px;">
                    <label for="valorTotalCompra" class="labelInput staticLabel">Valor Total da Compra (R$)</label>
                    <input type="text" id="valorTotalCompra" name="valorTotalCompra" class="valor-input" readonly value="0.00">
                </div>

                <div class="inputBox">
                    <input type="text" id="senha_pedido" name="senha_pedido" class="inputUser" maxlength="2" required>
                    <label for="senha_pedido" class="labelInput">Senha do Pedido</label>
                </div>

                <div style="display:flex; gap:8px; margin-top:10px;">
                    <button type="button" class="voltar-btn" onclick="voltarCategorias()">Voltar para Categorias</button>
                    <button id="submit-btn" type="submit">Enviar</button>
                </div>
            </fieldset>
        </form>
    </div>

    <script>
    // scripts: categorias, pre칞os, c치lculo e gera칞칚o de PDF ao submit
    document.addEventListener('DOMContentLoaded', () => {
        // pre칞os
        window.precosItens = {
            mussarela:25.00, calabresa:20.00, pepperoni:30.00, ragu_linguica:35.00, pannacotta:15.00,
            cuba:20.00, caipirinha:20.00, mojito:25.00, ginpesto:25.00, refrigerante:8.00, agua:5.00
        };

        // mostrar/esconder categorias e itens
        window.mostrarCategoria = function(categoria){
            document.getElementById('tela-categorias').style.display = 'none';
            document.getElementById('formulario-pedido').style.display = 'block';
            // mostra somente itens da categoria selecionada
            document.querySelectorAll('.item-pizza').forEach(el => el.style.display = categoria === 'pizzas' ? 'flex' : 'none');
            document.querySelectorAll('.item-bebida').forEach(el => el.style.display = categoria === 'bebidas' ? 'flex' : 'none');
        };
        window.voltarCategorias = function(){
            document.getElementById('tela-categorias').style.display = 'block';
            document.getElementById('formulario-pedido').style.display = 'none';
        };

        // c치lculo autom치tico
        const inputValorTotal = document.getElementById('valorTotalCompra');

        function atualizarValorTotal(){
            const checkboxes = document.querySelectorAll('input[name="item_pedido"]');
            let total = 0;
            checkboxes.forEach(cb => {
                const key = cb.value;
                const qtdEl = document.getElementById('qtd_' + key);
                const qtd = qtdEl ? parseInt(qtdEl.value, 10) || 0 : 0;
                if (qtd > 0) cb.checked = true;
                if (!cb.checked) return;
                const preco = Number(window.precosItens[key] || 0);
                total += preco * qtd;
            });
            inputValorTotal.value = total.toFixed(2);
        }

        // ouvintes
        document.querySelectorAll('input[name="item_pedido"]').forEach(cb => {
            cb.addEventListener('change', () => {
                const key = cb.value;
                const qtdEl = document.getElementById('qtd_' + key);
                if (cb.checked && qtdEl && (qtdEl.value === '' || Number(qtdEl.value) === 0)) qtdEl.value = 1;
                if (!cb.checked && qtdEl) qtdEl.value = 0;
                atualizarValorTotal();
            });
        });
        document.querySelectorAll('.qtd-input').forEach(q => {
            q.addEventListener('input', () => {
                const key = q.id.replace(/^qtd_/, '');
                const cb = document.querySelector('input[name="item_pedido"][value="'+key+'"]');
                const val = parseInt(q.value, 10) || 0;
                if (cb) cb.checked = val > 0;
                atualizarValorTotal();
            });
        });

        // c치lculo inicial
        atualizarValorTotal();

        // submit -> gera PDF com detalhes (nome, telefone, endereco opcional, itens com qtd e pre칞o, valor total, data)
        const form = document.getElementById('formulario-pedido');
        if (form) {
            form.addEventListener('submit', function(e){
                e.preventDefault();
                const get = id => document.getElementById(id)?.value || '';
                const nome = get('nome');
                const telefone = get('telefone');
                const endereco = get('endereco') || '';
                const cidade = get('cidade') || '';
                const senha = get('senha_pedido') || '';

                const checked = Array.from(document.querySelectorAll('input[name="item_pedido"]:checked'));
                const itens = checked.map(cb => {
                    const key = cb.value;
                    const qtd = parseInt(document.getElementById('qtd_' + key)?.value || '0', 10) || 0;
                    const precoUnit = Number(window.precosItens[key] || 0);
                    const totalItem = precoUnit * qtd;
                    const label = document.querySelector('label[for="'+cb.id+'"]');
                    const nomeItem = label ? label.textContent.split('-')[0].trim() : key;
                    return { nome: nomeItem, qtd, precoUnit, totalItem };
                });

                // gera PDF com jsPDF
                const jsPDFLib = (window.jspdf && window.jspdf.jsPDF) || window.jsPDF;
                if (!jsPDFLib) {
                    alert('Erro: jsPDF n칚o carregado.');
                    return;
                }
                const doc = new jsPDFLib();
                doc.setFontSize(16);
                doc.text('RuaRoma Sunset - Comprovante de Pedido', 20, 20);
                doc.setFontSize(12);
                let y = 36;
                if (nome) { doc.text('Nome: ' + nome, 20, y); y += 8; }
                if (telefone) { doc.text('Telefone: ' + telefone, 20, y); y += 8; }
                if (endereco) { doc.text('Endere칞o: ' + endereco, 20, y); y += 8; }
                if (cidade) { doc.text('Cidade: ' + cidade, 20, y); y += 8; }
                if (senha) { doc.text('Senha: ' + senha, 20, y); y += 12; }

                doc.text('Itens do Pedido:', 20, y); y += 8;
                if (itens.length === 0) {
                    doc.text('(Nenhum item selecionado)', 20, y); y += 8;
                } else {
                    itens.forEach(it => {
                        const line = `${it.nome} - Qtd: ${it.qtd} - R$ ${it.totalItem.toFixed(2)}`;
                        doc.text(line, 20, y);
                        y += 8;
                        if (y > 270) { doc.addPage(); y = 20; }
                    });
                }

                const valorTotal = document.getElementById('valorTotalCompra')?.value || '0.00';
                doc.setFontSize(14);
                doc.text('Valor Total: R$ ' + valorTotal, 20, y + 12);

                if (senha) { doc.setFontSize(12); doc.text('Senha: ' + senha, 20, y + 28); }

                doc.setFontSize(10);
                doc.text('Emitido em: ' + new Date().toLocaleString('pt-BR'), 20, y + 44);

                const filename = 'pedido-' + (senha || Date.now()) + '.pdf';
                doc.save(filename);
                alert('Pedido gerado em PDF: ' + filename);
                // opcional: form.reset();
            });
        }
    });
    </script>
</body>
</html>